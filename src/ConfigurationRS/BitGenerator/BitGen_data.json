{
  "gemini_bop" : {
    "size_alignment" : 32,
    "fields" : [
      {
        "name" : "id",
        "size" : 32
      },
      {
        "name" : "header_version",
        "size" : 16
      },
      {
        "name" : "tool_version",
        "size" : 16
      },
      {
        "name" : "binary_version",
        "size" : 32
      },
      {
        "name" : "binary_length",
        "size" : 32
      },
      {
        "name" : "load_address",
        "size" : 32
      },
      {
        "name" : "entry_address",
        "size" : 32
      },
      {
        "name" : "offset_to_binary",
        "size" : 32,
        "data" : 64
      },
      {
        "name" : "offset_to_next_bop",
        "size" : 32
      },
      {
        "name" : "signing_algo",
        "size" : 8
      },
      {
        "name" : "option",
        "size" : 8
      },
      {
        "name" : "encryption_algo",
        "size" : 8
      },
      {
        "name" : "iv_length",
        "size" : 8
      },
      {
        "name" : "public_key_length",
        "size" : 16
      },
      {
        "name" : "encryption_length",
        "size" : 16
      },
      {
        "name" : "signing_length",
        "size" : 16
      },
      {
        "name" : "compression_algo",
        "size" : 8
      },
      {
        "name" : "binary_padding_size",
        "size" : 8
      },
      {
        "name" : "xcb_header_size",
        "size" : 16
      },
      {
        "name" : "padding0",
        "size" : 64
      },
      {
        "name" : "padding1",
        "size" : 64
      },
      {
        "name" : "crc16",
        "size" : 16,
        "dependency" : "1",
        "data" : "@calc_crc(0, 0)"
      }
    ]
  },
  "gemini_fcb" : {
    "size_alignment" : 32,
    "defined" : { "bit_size_per_chain" : "(@get_rule_value(payload_size32) * 32)/(@align32(@get_rule_value(parallel_chain_size)))" }, 
    "fields" : [
      {
        "name" : "payload_size32",
        "size" : 32,
        "data" : "@size32(@align32(@get_src_value(parallel_chain_size)) * @get_src_value(bit_size_per_chain))"
      },
      {
        "name" : "checksum", 
        "size" : 32,
        "data" : "@calc_checksum(@get_rule_data(payload), 0)"
      },
      {
        "name" : "cmd", 
        "size" : 2,
        "data" : 1
      },
      {
        "name" : "bit_twist_shift_reg", 
        "size" : 1, 
        "data" : 0
      },
      {
        "name" : "bit_chain_connection", 
        "size" : 1, 
        "data" : 0
      },
      {
        "name" : "@align32"
      },
      {
        "name" : "parallel_chain_size", 
        "size" : 32
      },
      {
        "name" : "payload", 
        "size" : "@get_rule_value(payload_size32) * 32", 
        "data" : "@genbits_line_by_line(@get_src_data(src_payload), @get_src_value(parallel_chain_size), @get_src_value(bit_size_per_chain), 8, 32, @get_rule_value(bit_chain_connection) != 0, @get_rule_value(bit_twist_shift_reg) != 0)",
        "sdata_size" : "@get_defined_value(bit_size_per_chain)*(@size8(@get_rule_value(parallel_chain_size)))",
        "sdata" : "@genbits_line_by_line(data, @get_rule_value(parallel_chain_size), @get_defined_value(bit_size_per_chain), 8, 32, @get_rule_value(bit_chain_connection) != 0, @get_rule_value(bit_twist_shift_reg) != 0, @get_rule_data_ptr(payload))",
        "print_info" : "(uint64_t(8) << 40 | uint64_t(1) << 36) | (uint64_t(1) << 32) | @get_rule_value(parallel_chain_size)"
      }
    ]
  },
  "gemini_icb_packet" : {
    "size_alignment" : 32,
    "fields" : [
      {
        "name" : "payload_size8",
        "size" : 24,
        "data" : "@get_src_data_size(src_payload),4"
      },
      {
        "name" : "checksum_present",
        "size" : 1,
        "data" : 1
      },
      {
        "name" : "cmd",
        "size" : 2,
        "data" : 1
      },
      {
        "name" : "reserved",
        "size" : 2
      },
      {
        "name" : "update",
        "size" : 1
      },
      {
        "name" : "capture",
        "size" : 1
      },
      {
        "name" : "is_data",
        "size" : 1
      },
      {
        "name" : "checksum", 
        "size" : 32,
        "data" : "@calc_checksum(@get_rule_data(payload), 0)"
      },
      {
        "name" : "payload",
        "size" : "@get_rule_value(payload_size8) * 8",
        "data" : "@get_src_data(src_payload)",
        "print_info" : "1"
      }
    ]
  },
  "gemini_pcb_packet" : {
    "size_alignment" : 32,
    "size_check" : [
        { "src_payload" : 4 }
      ],
    "fields" : [
      {
        "name" : "payload_size32",
        "size" : 32,
        "data" : "@size32(@get_src_data_size(src_payload) * 8), 4096"
      },
      {
        "name" : "ram_block_count",
        "size" : 16,
        "data" : "@get_rule_value(payload_size32)/4096"
      },
      {
        "name" : "ctl_skew",
        "size" : 2
      },
      {
        "name" : "ctl_parity",
        "size" : 1,
        "data" : 1
      },
      {
        "name" : "ctl_even",
        "size" : 1
      },
      {
        "name" : "ctl_split",
        "size" : 2
      },
      {
        "name" : "@align32"
      },
      {
        "name" : "select_offset",
        "size" : 12
      },
      {
        "name" : "select_row",
        "size" : 10
      },
      {
        "name" : "select_col",
        "size" : 10
      },
      {
        "name" : "row_offset",
        "size" : 10
      },
      {
        "name" : "@align16"
      },
      {
        "name" : "row_stride",
        "size" : 10,
        "data" : 1
      },
      {
        "name" : "@align16"
      },
      {
        "name" : "col_offset",
        "size" : 10
      },
      {
        "name" : "@align16"
      },
      {
        "name" : "col_stride",
        "size" : 10,
        "data" : 1
      },
      {
        "name" : "@align16"
      },
      {
        "name" : "extra_w",
        "size" : 4
      },
      {
        "name" : "@align32"
      },
      {
        "name" : "@align128"
      },
      {
        "name" : "payload",
        "size" : "@get_rule_value(payload_size32) * 32, 4096 * 32",
        "data" : "@get_src_data(src_payload)",
        "print_info" : "(uint64_t(4) << 40) | (uint64_t(2) << 32) | 4096 * 4"
      }
    ]
  }
}
